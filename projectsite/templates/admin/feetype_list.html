{% extends "base.html" %}

{% block title %}Fee Types{% endblock %}

{% block content %}
<div class="up-card overflow-hidden">
    <!-- Header with Gradient -->
    <div class="bg-gradient-to-r from-emerald-600 via-teal-500 to-orange-500 px-6 py-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
            <div>
                <h4 class="text-white mb-1 fw-semibold d-flex align-items-center gap-2">
                    <i data-lucide="tags" class="w-5 h-5"></i>
                    Fee Types
                </h4>
                <p class="text-white opacity-75 mb-0 small">
                    {% if is_super_officer %}
                        Managing fee types for {{ organization.name }}
                    {% else %}
                        Manage organization fee types
                    {% endif %}
                </p>
            </div>
            {% if user.is_staff %}
            <a href="{% url 'create_fee_type' %}" class="btn btn-light btn-sm d-flex align-items-center gap-2">
                <i data-lucide="plus" class="w-4 h-4"></i>
                Create New
            </a>
            {% endif %}
        </div>
    </div>

    <!-- Filters -->
    <div class="p-4 bg-gray-50 border-bottom">
        <form method="get" class="d-flex flex-wrap gap-3 align-items-end">
            <div class="flex-grow-1" style="min-width: 200px;">
                <label class="form-label small text-muted mb-1">Filter by Organization</label>
                <select name="organization" class="form-select form-select-sm">
                    <option value="">All Organizations</option>
                    {% for org in organizations %}
                        <option value="{{ org.pk }}" {% if request.GET.organization == org.pk|stringformat:"s" %}selected{% endif %}>{{ org.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-sm btn-primary d-flex align-items-center gap-1">
                    <i data-lucide="filter" class="w-4 h-4"></i>
                    Filter
                </button>
                <a href="{% url 'feetype_list' %}" class="btn btn-sm btn-outline-secondary">Clear</a>
            </div>
        </form>
    </div>

    <!-- Table -->
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead class="bg-light">
                <tr>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase">Organization</th>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase">Fee Name</th>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase">Amount</th>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase">Period</th>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase">Status</th>
                    <th class="px-4 py-3 text-xs font-semibold text-gray-500 text-uppercase text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y">
                {% for fee in fee_types %}
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3">
                        <span class="badge bg-emerald-100 text-emerald-700">{{ fee.organization.code }}</span>
                    </td>
                    <td class="px-4 py-3">
                        <div class="fw-medium">{{ fee.name }}</div>
                        <div class="text-muted small">{{ fee.applicable_year_levels }}</div>
                    </td>
                    <td class="px-4 py-3">
                        <span class="fw-semibold text-emerald-600">â‚±{{ fee.amount|floatformat:2 }}</span>
                    </td>
                    <td class="px-4 py-3">
                        <div class="small">{{ fee.academic_year }}</div>
                        <div class="text-muted small">{{ fee.semester }}</div>
                    </td>
                    <td class="px-4 py-3">
                        {% if fee.is_active %}
                            <span class="badge bg-success-subtle text-success">Active</span>
                        {% else %}
                            <span class="badge bg-secondary-subtle text-secondary">Inactive</span>
                        {% endif %}
                        {% if fee.is_overdue %}
                            <span class="badge bg-danger-subtle text-danger">Overdue</span>
                        {% endif %}
                    </td>
                    <td class="px-4 py-3 text-center">
                        <div class="d-flex gap-1 justify-content-center">
                            <a href="{% url 'feetype_detail' fee.pk %}" class="btn btn-sm btn-outline-primary" title="View Details">
                                <i data-lucide="eye" class="w-4 h-4"></i>
                            </a>
                            <a href="{% url 'feetype_update' fee.pk %}" class="btn btn-sm btn-outline-warning" title="Edit">
                                <i data-lucide="edit" class="w-4 h-4"></i>
                            </a>
                            <a href="{% url 'feetype_delete' fee.pk %}" class="btn btn-sm btn-outline-danger" title="Delete">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="px-4 py-5 text-center">
                        <div class="d-flex flex-column align-items-center">
                            <div class="rounded-circle bg-gray-100 p-3 mb-3">
                                <i data-lucide="tags" class="w-6 h-6 text-gray-400"></i>
                            </div>
                            <p class="text-muted mb-0">No fee types found.</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    {% if is_paginated %}
    <div class="p-4 bg-gray-50 border-top">
        <nav aria-label="Page navigation">
            <ul class="pagination pagination-sm justify-content-center mb-0">
                {% if page_obj.has_previous %}
                    <li class="page-item"><a class="page-link" href="?page=1{% if request.GET.organization %}&organization={{ request.GET.organization }}{% endif %}">First</a></li>
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if request.GET.organization %}&organization={{ request.GET.organization }}{% endif %}">Previous</a></li>
                {% endif %}
                <li class="page-item active"><span class="page-link">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span></li>
                {% if page_obj.has_next %}
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}{% if request.GET.organization %}&organization={{ request.GET.organization }}{% endif %}">Next</a></li>
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.organization %}&organization={{ request.GET.organization }}{% endif %}">Last</a></li>
                {% endif %}
            </ul>
        </nav>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
});
</script>
{% endblock %}












